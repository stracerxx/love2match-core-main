{
  "name": "GiftTransaction",
  "type": "object",
  "properties": {
    "gift_id": {"type": "string", "description": "ID of the gift"},
    "sender_email": {"type": "string", "description": "Email of gift sender"},
    "receiver_email": {"type": "string", "description": "Email of gift receiver"},
    "message": {"type": "string", "description": "Personal message with gift"},
    "status": {"type": "string", "enum": ["sent", "received", "redeemed"], "default": "sent", "description": "Gift transaction status"},
    "tokens_spent": {"type": "number", "description": "LOVE tokens spent"},
    "tokens_redeemed": {"type": "number", "description": "LOVE tokens redeemed"},
    "redeemed_at": {"type": "string", "format": "date-time", "description": "When gift was redeemed"}
  },
  "required": ["gift_id", "sender_email", "receiver_email", "tokens_spent"],
  "rls": {
    "create": {"created_by": "{{user.email}}"},
    "read": {"$or": [{"sender_email": "{{user.email}}"}, {"receiver_email": "{{user.email}}"}]},
    "update": {"$or": [{"sender_email": "{{user.email}}"}, {"receiver_email": "{{user.email}}"}]},
    "delete": {"user_condition": {"role": "admin"}}
  }
}